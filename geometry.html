index.html
<!DOCTYPE html>
<html lang="no">
<head>
<meta charset="UTF-8">
<title>Geometry Dash – Endless Edition</title>
<style>
body {
  margin: 0;
  background: linear-gradient(to bottom, #87CEFA, #FFFFFF); 
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  font-family: Arial, sans-serif;
  user-select: none;
}
canvas {
  background: linear-gradient(to bottom, #A0E7E5, #B4F8C8);
  border: 3px solid #FF69B4; 
  box-shadow: 0 0 20px #FF69B4;
}
button {
  padding: 10px 20px;
  font-size: 18px;
  margin: 10px;
  cursor: pointer;
  border: none;
  border-radius: 5px;
  transition: 0.2s;
}
button:hover {
  background-color: #FFD700;
}
#ui-container {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
}
.progress-bar {
  width: 900px;
  height: 10px;
  background: #ddd;
  border: 2px solid #333;
  margin-bottom: 5px;
  border-radius: 5px;
}
.progress-fill {
  height: 100%;
  background: #FF69B4;
  width: 0%;
  border-radius: 5px;
}
.death-counter {
  font-size: 18px;
  color: #FF0000;
  font-weight: bold;
  margin-bottom: 5px;
}
</style>
</head>
<body>

<canvas id="game" width="900" height="350"></canvas>
<div id="ui-container"></div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
const ui = document.getElementById("ui-container");

let state = "menu"; // menu, play, pause, gameover, levelcomplete
const speed = 4;

let deathCount = 0;

let player = {
  x: 120,
  y: 260,
  size: 30,
  dy: 0,
  gravity: 0.9,
  angle: 0,
  alive: true,
  checkpoint: {x:120, y:260},
  distance:0
};

// Endless level data
let objects = [];
let lastGeneratedX = 900; // hvor langt vi har generert
const segmentLength = 400;

// UI
let buttons = [];
let progressFill;

function createButton(text, onClick) {
  const btn = document.createElement("button");
  btn.innerText = text;
  btn.onclick = onClick;
  ui.appendChild(btn);
  buttons.push(btn);
  return btn;
}

function clearButtons(){
  buttons.forEach(b=>ui.removeChild(b));
  buttons=[];
}

function createProgressBar(){
  const container = document.createElement("div");
  container.className="progress-bar";
  progressFill=document.createElement("div");
  progressFill.className="progress-fill";
  container.appendChild(progressFill);
  ui.appendChild(container);
}

function updateProgress(){
  if(progressFill) progressFill.style.width=Math.min(player.distance/2000*100,100)+"%";
}

function createDeathCounter(){
  const counter=document.createElement("div");
  counter.className="death-counter";
  counter.id="death-counter";
  counter.innerText="Deaths: "+deathCount;
  ui.appendChild(counter);
}

function updateDeathCounter(){
  const counter=document.getElementById("death-counter");
  if(counter) counter.innerText="Deaths: "+deathCount;
}

// Start spill
function startGame(){
  state="play";
  player.y=260;
  player.dy=0;
  player.angle=0;
  player.alive=true;
  player.distance=0;
  player.checkpoint={x:120, y:260};
  objects=[];
  lastGeneratedX=900;
  clearButtons();
  createProgressBar();
  createDeathCounter();
  generateSegment(); // start første segment
}

// Pause
function togglePause(){
  if(state!=="play") return;
  state="pause";
  clearButtons();
  createPauseMenu();
}
function resumeGame(){
  state="play";
  clearButtons();
  createProgressBar();
  createDeathCounter();
}

// Game Over
function gameOver(){
  deathCount++;
  updateDeathCounter();
  state="gameover";
  clearButtons();
  createGameOverMenu();
}

function createGameOverMenu(){
  createButton("Restart", startGame);
  createButton("Main Menu", ()=>{state="menu"; clearButtons();});
}

function createPauseMenu(){
  createButton("Resume", resumeGame);
  createButton("Restart", startGame);
  createButton("Main Menu", ()=>{state="menu"; clearButtons();});
}

// Key handling
document.addEventListener("keydown", e=>{
  if(state==="menu") startGame();
  else if(state==="play"){
    if(e.code==="Escape") togglePause();
    else if(player.y>=260) player.dy=-15;
  }else if(state==="pause" && e.code==="Escape") resumeGame();
});

// Generer nye nivåsegmenter
function generateSegment(){
  const types=["spikeSmall","spikeLarge","block","checkpoint"];
  let x = lastGeneratedX;
  for(let i=0;i<8;i++){
    const type = types[Math.floor(Math.random()*types.length)];
    const y = type==="block"?260-Math.floor(Math.random()*3)*40:260;
    if(type==="checkpoint" && i!==0) objects.push({type:"checkpoint", x:x, y:260});
    else if(type==="spikeSmall"||type==="spikeLarge") objects.push({type:type, x:x, y:y});
    else if(type==="block") objects.push({type:"block", x:x, y:y, width:40, height:40});
    x += segmentLength/8;
  }
  lastGeneratedX=x;
  // Goal på slutten av segment (valgfritt)
  objects.push({type:"goal", x:lastGeneratedX, y:260});
}

// Tegning
function drawMenu(){
  ctx.fillStyle="#FF1493";
  ctx.font="48px Arial";
  ctx.fillText("GEOMETRY DASH",180,150);
  ctx.font="20px Arial";
  ctx.fillText("Press any key to start",300,200);
}

function drawPlayer(){
  ctx.save();
  ctx.translate(player.x+15,player.y+15);
  ctx.rotate(player.angle);
  ctx.fillStyle="#FFD700";
  ctx.fillRect(-15,-15,30,30);
  ctx.restore();
}

function drawObjects(){
  objects.forEach(obj=>{
    if(obj.type==="spikeSmall"||obj.type==="spikeLarge"){
      ctx.fillStyle=obj.type==="spikeSmall"?"#FF4500":"#FF0000";
      const h=obj.type==="spikeSmall"?20:40;
      ctx.beginPath();
      ctx.moveTo(obj.x,300);
      ctx.lineTo(obj.x+20,300-h);
      ctx.lineTo(obj.x+40,300);
      ctx.fill();
      if(player.x+player.size>obj.x && player.x<obj.x+40 && player.y+player.size>300-h){
        player.x=player.checkpoint.x;
        player.y=player.checkpoint.y;
        player.dy=0;
        deathCount++;
        updateDeathCounter();
      }
    }
    else if(obj.type==="block"){
      ctx.fillStyle="#8B4513";
      ctx.fillRect(obj.x,obj.y,obj.width,obj.height);
      if(player.x+player.size>obj.x && player.x<obj.x+obj.width && player.y+player.size>obj.y){
        player.x=player.checkpoint.x;
        player.y=player.checkpoint.y;
        player.dy=0;
        deathCount++;
        updateDeathCounter();
      }
    }
    else if(obj.type==="checkpoint"){
      ctx.fillStyle="#00FFFF";
      ctx.fillRect(obj.x,obj.y-30,20,30);
      if(player.x+player.size>obj.x && player.x<obj.x+20 && player.y+player.size>obj.y-30){
        player.checkpoint={x:obj.x, y:obj.y};
      }
    }
    else if(obj.type==="goal"){
      ctx.fillStyle="#32CD32";
      ctx.fillRect(obj.x,obj.y-40,30,40);
      if(player.x+player.size>obj.x && player.x<obj.x+30 && player.y+player.size>obj.y-40){
        state="levelcomplete";
        clearButtons();
        createButton("Next Segment", ()=>{
          generateSegment();
          state="play";
          clearButtons();
          createProgressBar();
        });
      }
    }
  });
}

// Main loop
function update(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(state==="menu") drawMenu();
  else if(state==="play"){
    player.dy+=player.gravity;
    player.y+=player.dy;
    if(player.y>=260){player.y=260; player.dy=0;} else player.angle+=0.15;

    objects.forEach(obj=>obj.x-=speed);
    player.distance+=speed;
    updateProgress();

    // Generer nytt segment hvis siste mål nærmer seg skjerm
    if(objects.length && objects[objects.length-1].x<canvas.width+200){
      generateSegment();
    }

    drawPlayer();
    drawObjects();

    ctx.fillStyle="#32CD32";
    ctx.fillRect(0,300,canvas.width,4);
  }

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
